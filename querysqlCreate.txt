-- This script was generated by a beta version of the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS "schemaControlePonto".at_periodo
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    id_at integer NOT NULL,
    id_periodo integer NOT NULL,
    CONSTRAINT at_periodo_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".atrasos
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    descricao text COLLATE pg_catalog."default",
    CONSTRAINT atrasos_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".he_periodo
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    id_he integer NOT NULL,
    id_periodo integer NOT NULL,
    CONSTRAINT he_periodo_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".historico
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    date date NOT NULL,
    id_ht integer NOT NULL,
    id_mf integer NOT NULL,
    id_he integer NOT NULL,
    id_at integer NOT NULL,
    CONSTRAINT historico_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".hora_extra
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    descricao text COLLATE pg_catalog."default",
    CONSTRAINT hora_extra_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".horario_trabalho
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    descricao text COLLATE pg_catalog."default",
    CONSTRAINT horario_trabalho_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".ht_periodo
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    id_ht integer NOT NULL,
    id_periodo integer NOT NULL,
    CONSTRAINT ht_periodo_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".marcacoes_feitas
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    descricao text COLLATE pg_catalog."default",
    CONSTRAINT marcacoes_feitas_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".mf_periodo
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    id_mf integer NOT NULL,
    id_periodo integer NOT NULL,
    CONSTRAINT mf_periodo_pkey PRIMARY KEY (id)
);

CREATE TABLE IF NOT EXISTS "schemaControlePonto".periodo
(
    id integer NOT NULL GENERATED ALWAYS AS IDENTITY ( INCREMENT 1 START 1 MINVALUE 1 MAXVALUE 2147483647 CACHE 1 ),
    entry integer NOT NULL,
    exit integer NOT NULL,
    CONSTRAINT periodo_pkey PRIMARY KEY (id)
);

ALTER TABLE IF EXISTS "schemaControlePonto".at_periodo
    ADD CONSTRAINT at_periodo_id_at_fkey FOREIGN KEY (id_at)
    REFERENCES "schemaControlePonto".atrasos (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS "schemaControlePonto".at_periodo
    ADD CONSTRAINT at_periodo_id_periodo_fkey FOREIGN KEY (id_periodo)
    REFERENCES "schemaControlePonto".periodo (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS "schemaControlePonto".he_periodo
    ADD CONSTRAINT he_periodo_id_he_fkey FOREIGN KEY (id_he)
    REFERENCES "schemaControlePonto".hora_extra (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS "schemaControlePonto".he_periodo
    ADD CONSTRAINT he_periodo_id_periodo_fkey FOREIGN KEY (id_periodo)
    REFERENCES "schemaControlePonto".periodo (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION;


ALTER TABLE IF EXISTS "schemaControlePonto".historico
    ADD CONSTRAINT "FK_at" FOREIGN KEY (id_at)
    REFERENCES "schemaControlePonto".atrasos (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".historico
    ADD CONSTRAINT "FK_he" FOREIGN KEY (id_he)
    REFERENCES "schemaControlePonto".hora_extra (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".historico
    ADD CONSTRAINT "FK_ht" FOREIGN KEY (id_ht)
    REFERENCES "schemaControlePonto".horario_trabalho (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".historico
    ADD CONSTRAINT "FK_mf" FOREIGN KEY (id_mf)
    REFERENCES "schemaControlePonto".marcacoes_feitas (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".ht_periodo
    ADD CONSTRAINT "FK_ht" FOREIGN KEY (id_ht)
    REFERENCES "schemaControlePonto".horario_trabalho (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".ht_periodo
    ADD CONSTRAINT "FK_periodo" FOREIGN KEY (id_periodo)
    REFERENCES "schemaControlePonto".periodo (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".mf_periodo
    ADD CONSTRAINT "FK_mf" FOREIGN KEY (id_mf)
    REFERENCES "schemaControlePonto".marcacoes_feitas (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS "schemaControlePonto".mf_periodo
    ADD CONSTRAINT "FK_periodo" FOREIGN KEY (id_periodo)
    REFERENCES "schemaControlePonto".periodo (id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

END;